{"version":3,"sources":["file:///C:/PROJECT/COCOS/SRC/2025/BLOCK_PUZZLE_SAGA/assets/script/preloadSceneClass.ts"],"names":["TPreloadSceneClass","Label","Prefab","SpriteFrame","instantiate","resources","PRELOAD_STATUS","TSceneClass","constructor","root","sceneManager","owner","preloadPrefab","lblResourceLoad","resourceCount","resourceCountMax","status","gameData","NONE","startScene","preload","load","err","prefab","console","log","INIT","gameImageLoad","gameName","data","gameImageLists","set","updateResourceLoadCount","init","scene","getChildByPath","getComponent","string","addChild","count","toString","slice","countMax","update","deltaTime","PRELOAD","INIT_STAND","setGameListAllDefault","getGameListUserAtLocalStorage","getUserInfoCoinAtLocalStorate","getDailyPromotionAtLocalStorate","setAddGameListAddValueAll","getWatchVideoCoinTimeAll","setGameListRankAllDefault","PRELOAD_STAND","changeCurrentScene"],"mappings":"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","sourcesContent":["import { Label, Node, Prefab, SpriteFrame, game, instantiate, resources } from \"cc\"\r\nimport { PRELOAD_STATUS, TSceneClass, TSceneManager } from \"./utils\";\r\nimport { TWebGameClass } from \"./rootScene\";\r\nimport { TGameDataClass } from \"./gameDataClass\";\r\n\r\nexport class TPreloadSceneClass extends TSceneClass {\r\n    preloadPrefab: Prefab;\r\n    lblResourceLoad: Label;\r\n    resourceCount: number;\r\n    resourceCountMax: number;\r\n    status: PRELOAD_STATUS;\r\n    owner: TWebGameClass;\r\n\r\n    gameData: TGameDataClass;\r\n    constructor(root: Node, sceneManager: TSceneManager, owner: TWebGameClass) {\r\n        super(root, sceneManager);\r\n        this.status = PRELOAD_STATUS.NONE;\r\n        this.resourceCount = 0;\r\n        this.resourceCountMax = 24;\r\n        this.owner = owner;\r\n        this.gameData = this.owner.gameData;\r\n    }\r\n\r\n    startScene(): void {\r\n        this.preload();\r\n    }\r\n\r\n    preload() {\r\n        resources.load('prefab/scene/fabPreloadScene', Prefab, (err: Error, prefab: Prefab) => {\r\n            if (err) {\r\n                console.log(err);\r\n            } else {\r\n                this.preloadPrefab = prefab;\r\n                this.status = PRELOAD_STATUS.INIT;\r\n            }\r\n        });\r\n    }\r\n\r\n    gameImageLoad(gameName: string) {\r\n        resources.load('image/gameList/' + gameName + '/spriteFrame', SpriteFrame, (err: Error, data: SpriteFrame) => {\r\n            if (err) {\r\n                console.log(err);\r\n            } else {\r\n                this.owner.gameImageLists.set(gameName, data);\r\n                this.resourceCount++;\r\n                this.updateResourceLoadCount();\r\n            }\r\n        });\r\n    }\r\n\r\n    init() {\r\n        this.scene = instantiate(this.preloadPrefab);\r\n        this.lblResourceLoad = this.scene.getChildByPath('preloadScene/lblResourceLoad').getComponent(Label);\r\n        this.lblResourceLoad.string = 'RESOURCE LOAD (000/000)'\r\n        this.root.addChild(this.scene);\r\n    }\r\n\r\n    updateResourceLoadCount() {\r\n        let count = this.resourceCount.toString();\r\n        count = (\"00\" + count).slice(-3);\r\n        let countMax = this.resourceCountMax.toString();\r\n        countMax = (\"00\" + countMax).slice(-3);\r\n        this.lblResourceLoad.string = 'RESOURCE LOAD (' + count + '/' + countMax + ')';\r\n    }\r\n\r\n    update(deltaTime: number): void {\r\n        switch (this.status) {\r\n            case PRELOAD_STATUS.INIT:\r\n                this.init();\r\n                this.updateResourceLoadCount();\r\n                this.status = PRELOAD_STATUS.PRELOAD;\r\n                break;\r\n            case PRELOAD_STATUS.INIT_STAND:\r\n                break;\r\n            case PRELOAD_STATUS.PRELOAD:\r\n\r\n                this.gameImageLoad('BOX_BOB');\r\n                this.gameImageLoad('TETRA_BLOCKS');\r\n                this.gameImageLoad('BLOCK_SLIDER');\r\n\r\n                this.gameImageLoad('MONSTER_MATCH');\r\n\r\n                this.gameImageLoad('HEAP_UP_BOX');\r\n                this.gameImageLoad('PICO_TETRIS');\r\n                this.gameImageLoad('MY_T3TR1S');\r\n                this.gameImageLoad('BRICK_BLOCK_GAME');\r\n                this.gameImageLoad('SLIDING_BRICKS');\r\n\r\n                this.gameImageLoad('BLOCKS_TRIANGLE_PUZZLE');\r\n                this.gameImageLoad('HEXAGON_FALL');\r\n                this.gameImageLoad('BLOCKS_FILL');\r\n                this.gameImageLoad('WOODEN_SLIDE');\r\n                this.gameImageLoad('BLOCK_UP');\r\n\r\n                this.gameImageLoad('MAGNETIC_BLOCKS');\r\n                this.gameImageLoad('MAGIC_HEROBRINE');\r\n                this.gameImageLoad('BLOCKS_MUST_FALL');\r\n                this.gameImageLoad('STACKY_STACK');\r\n                this.gameImageLoad('JELLY_BLOCKS');\r\n\r\n                this.gameImageLoad('PUSH_OUT');\r\n                this.gameImageLoad('ZERO_SQUARES');\r\n                this.gameImageLoad('HEXA_JUNGLE');\r\n                this.gameImageLoad('SPINNING_BLOCK');\r\n                this.gameImageLoad('SWITCHWAYS_DIMENSIONS');\r\n\r\n                // this.gameData.getGameListAllAtServer();\r\n                // this.gameData.getGameListAllAtLocalStorage();\r\n                this.gameData.setGameListAllDefault();\r\n                this.gameData.getGameListUserAtLocalStorage();\r\n                this.gameData.getUserInfoCoinAtLocalStorate();\r\n                this.gameData.getDailyPromotionAtLocalStorate();\r\n                this.gameData.setAddGameListAddValueAll();\r\n                this.gameData.getWatchVideoCoinTimeAll();\r\n                this.gameData.setGameListRankAllDefault();\r\n                this.status = PRELOAD_STATUS.PRELOAD_STAND;\r\n                break;\r\n\r\n            case PRELOAD_STATUS.PRELOAD_STAND:\r\n                if (this.resourceCount >= this.resourceCountMax) {\r\n                    this.status = PRELOAD_STATUS.NONE;\r\n                    this.sceneManager.changeCurrentScene('MAIN_SCENE');\r\n                }\r\n                break;\r\n        }\r\n    }\r\n}"]}